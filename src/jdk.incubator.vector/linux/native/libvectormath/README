# Maintenance notes of importing sleef source code

## Motivation
In case we need to sync sleef in jdk with updates from sleef repo itself, please follow below steps.

## Steps of maintenance

### step 1: clone sleef repo
location: https://github.com/shibatch/sleef

### step 2: build sleef
build steps: https://github.com/shibatch/sleef?tab=readme-ov-file#how-to-build-sleef

NOTE: necessary options passed to cmake when building sleef:
* -DSLEEF_BUILD_INLINE_HEADERS=ON
* -DSLEEF_ENFORCE_SVE=ON

### step 3: import sleef files into jdk
sleef source and generated source:
* ${SLEEF_SRC_DIR}/common/misc.h
* ${SLEEF_BUILD_DIR}/include/sleefinline_advsimd.h
* ${SLEEF_BUILD_DIR}/include/sleefinline_sve.h

jdk dir:
* ${JDK_SRC_DIR}/jdk.incubator.vector/linux/native/libvectormath/

### step 4: make necessary changes to resolve any build issues in case there is any.

Currently, there is no necessary changes in sleef files to make it work for jdk.
* previous issues are resolved by https://github.com/shibatch/sleef/pull/537, https://github.com/shibatch/sleef/pull/536

### step 5: overwrite the files under the sleef directory with updated versions
src/jdk.incubator.vector/linux/native/sleef contains a subset of the
SLEEF source files: OpenJDK-local copies of the sources required to
regenerate the headers used by libvectorpath.  These are for use by
OpenJDK maintainers who prefer to use OpenJDK's own repository files and
build machinery to generate the headers.

### step 6: make sure everything is committed

### step 7: make regenerate-sleef-headers

### step 8: run `git status` to see if checked-in headers stayed identical
If any of the checked-in headers (sleefinline_sve.h,
sleefinline_advsimd.h) changed, please update the SetupSleefIntermediate
calls in make/modules/jdk.incubator.vector/SleefCommon.gmk to match what
CMake does, until the generated headers are identical.
